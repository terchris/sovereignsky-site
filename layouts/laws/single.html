{{ define "main" }}
{{ .Scratch.Set "scope" "single" }}

{{/* Get law data from frontmatter */}}
{{ $lawId := .Params.law_id | default "" }}
{{ $fullName := .Params.full_name | default "" }}
{{ $year := .Params.year | default 0 }}
{{ $scope := .Params.scope | default "national" }}
{{ $appliesTo := .Params.applies_to | default (slice) }}
{{ $url := .Params.source_url | default "" }}

{{/* New multi-dimensional classification fields */}}
{{ $lawType := .Params.law_type | default "privacy" }}
{{ $governmentAccess := .Params.government_access | default "none" }}
{{ $dataProtection := .Params.data_protection | default "none" }}
{{ $extraterritorial := .Params.extraterritorial | default false }}
{{ $requiresLocalization := .Params.requires_localization | default false }}
{{ $requiresBackdoor := .Params.requires_backdoor | default false }}

{{/* Optional richer descriptions (from laws.json via generator) */}}
{{ $reviewStatus := .Params.review_status | default "ai-generated" }}
{{ $whatItDoes := .Params.what_it_does | default (slice) }}
{{ $whoItAppliesTo := .Params.who_it_applies_to | default (slice) }}
{{ $keyProvisions := .Params.key_provisions | default (slice) }}
{{ $complianceActions := .Params.compliance_actions | default (slice) }}
{{ $enforcement := .Params.enforcement | default dict }}

{{/* Build lookup maps for regions and blocs */}}
{{ $regionsById := dict }}
{{ range (site.Data.regions | default (slice)) }}
  {{ $regionsById = merge $regionsById (dict .id .) }}
{{ end }}

{{ $blocsById := dict }}
{{ range (site.Data.jurisdictions.blocs | default (slice)) }}
  {{ $blocsById = merge $blocsById (dict .id .) }}
{{ end }}

{{/* Law Type badge styling */}}
{{ $typeEmoji := "" }}
{{ $typeLabel := $lawType }}
{{ $typeClass := "bg-neutral-100 dark:bg-neutral-800 text-neutral-700 dark:text-neutral-300" }}
{{ if eq $lawType "privacy" }}
  {{ $typeEmoji = "üõ°Ô∏è" }}
  {{ $typeLabel = "Privacy" }}
  {{ $typeClass = "bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200" }}
{{ else if eq $lawType "access" }}
  {{ $typeEmoji = "üîì" }}
  {{ $typeLabel = "Access" }}
  {{ $typeClass = "bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200" }}
{{ else if eq $lawType "surveillance" }}
  {{ $typeEmoji = "üëÅÔ∏è" }}
  {{ $typeLabel = "Surveillance" }}
  {{ $typeClass = "bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200" }}
{{ else if eq $lawType "localization" }}
  {{ $typeEmoji = "üìç" }}
  {{ $typeLabel = "Localization" }}
  {{ $typeClass = "bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200" }}
{{ else if eq $lawType "security" }}
  {{ $typeEmoji = "üîí" }}
  {{ $typeLabel = "Security" }}
  {{ $typeClass = "bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200" }}
{{ else if eq $lawType "sector" }}
  {{ $typeEmoji = "üìã" }}
  {{ $typeLabel = "Sector" }}
  {{ $typeClass = "bg-neutral-100 dark:bg-neutral-800 text-neutral-700 dark:text-neutral-300" }}
{{ end }}

{{/* Government Access badge styling */}}
{{ $accessClass := "bg-neutral-100 dark:bg-neutral-800 text-neutral-700 dark:text-neutral-300" }}
{{ $accessLabel := $governmentAccess }}
{{ if eq $governmentAccess "broad" }}
  {{ $accessLabel = "Broad" }}
  {{ $accessClass = "bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200" }}
{{ else if eq $governmentAccess "targeted" }}
  {{ $accessLabel = "Targeted" }}
  {{ $accessClass = "bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200" }}
{{ else if eq $governmentAccess "limited" }}
  {{ $accessLabel = "Limited" }}
  {{ $accessClass = "bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200" }}
{{ else if eq $governmentAccess "none" }}
  {{ $accessLabel = "None" }}
  {{ $accessClass = "bg-neutral-100 dark:bg-neutral-800 text-neutral-700 dark:text-neutral-300" }}
{{ end }}

{{/* Data Protection badge styling */}}
{{ $protectionClass := "bg-neutral-100 dark:bg-neutral-800 text-neutral-700 dark:text-neutral-300" }}
{{ $protectionLabel := $dataProtection }}
{{ if eq $dataProtection "strong" }}
  {{ $protectionLabel = "Strong" }}
  {{ $protectionClass = "bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200" }}
{{ else if eq $dataProtection "moderate" }}
  {{ $protectionLabel = "Moderate" }}
  {{ $protectionClass = "bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200" }}
{{ else if eq $dataProtection "weak" }}
  {{ $protectionLabel = "Weak" }}
  {{ $protectionClass = "bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200" }}
{{ else if eq $dataProtection "none" }}
  {{ $protectionLabel = "None" }}
  {{ $protectionClass = "bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200" }}
{{ end }}

{{/* Scope label */}}
{{ $scopeLabel := "National" }}
{{ if eq $scope "bloc" }}
  {{ $scopeLabel = "Bloc/Regional" }}
{{ end }}

{{/* Build applies-to items with metadata */}}
{{ $appliesToItems := slice }}
{{ range $appliesTo }}
  {{ $id := . }}
  {{ $name := $id }}
  {{ $flag := "" }}
  {{ $slug := "" }}
  {{ $type := "country" }}

  {{/* Check if it's a region (country) */}}
  {{ $region := index $regionsById $id }}
  {{ if $region }}
    {{ $name = $region.name | default $id }}
    {{ $flag = $region.flag | default "" }}
    {{ $slug = $region.slug | default "" }}
  {{ else }}
    {{/* Check if it's a bloc */}}
    {{ $bloc := index $blocsById $id }}
    {{ if $bloc }}
      {{ $name = $bloc.name | default $id }}
      {{ $flag = $bloc.flag | default "" }}
      {{ $slug = $bloc.slug | default "" }}
      {{ $type = "bloc" }}
    {{ end }}
  {{ end }}

  {{ $appliesToItems = $appliesToItems | append (dict "id" $id "name" $name "flag" $flag "slug" $slug "type" $type) }}
{{ end }}

<article class="max-w-full">
  {{/* Detail Header with breadcrumbs */}}
  {{ partial "detail-header.html" (dict
      "title" .Title
      "description" $fullName
      "icon" "scale"
      "breadcrumbs" (slice
          (dict "title" "Laws" "url" "/laws/")
      )
  ) }}

  {{/* Body with right sidebar */}}
  <section class="flex flex-col max-w-full mt-0 lg:flex-row">
    {{ $topClass := cond (hasPrefix site.Params.header.layout "fixed") "lg:top-[140px]" "lg:top-10" }}

    {{/* Right sidebar with law metadata */}}
    <div class="order-first px-0 lg:order-last lg:ps-8 lg:max-w-xs lg:min-w-[260px] lg:flex-shrink-0">
      <div class="print:hidden lg:sticky {{ $topClass }} space-y-4">

        {{/* Official source link */}}
        {{ if $url }}
        <a class="btn btn-primary btn-outline w-full gap-2"
           href="{{ $url }}"
           target="_blank"
           rel="noopener noreferrer">
          {{ partial "content-icon.html" (dict "name" "external" "size" "4") }}
          Official text
        </a>
        {{ end }}

        {{/* Law Details Card */}}
        <div class="card bg-base-100 shadow-sm border border-base-300">
          <div class="card-body p-4">
            <h3 class="card-title text-sm font-semibold flex items-center gap-2">
              {{ partial "content-icon.html" (dict "name" "info" "color" "primary" "size" "4") }}
              Details
            </h3>
            <dl class="mt-2 text-sm">
              {{/* Year */}}
              {{ if $year }}
              <div class="flex justify-between py-1">
                <dt class="text-neutral-500 dark:text-neutral-400">Year</dt>
                <dd class="font-medium">{{ $year }}</dd>
              </div>
              {{ end }}

              {{/* Law Type */}}
              <div class="flex justify-between py-1">
                <dt class="text-neutral-500 dark:text-neutral-400">Type</dt>
                <dd class="font-medium {{ if eq $lawType "privacy" }}text-success{{ else if eq $lawType "access" }}text-warning{{ else if eq $lawType "surveillance" }}text-error{{ end }}">
                  {{ $typeEmoji }} {{ $typeLabel }}
                </dd>
              </div>

              {{/* Government Access */}}
              <div class="flex justify-between py-1">
                <dt class="text-neutral-500 dark:text-neutral-400">Gov Access</dt>
                <dd class="font-medium {{ if eq $governmentAccess "limited" }}text-success{{ else if eq $governmentAccess "targeted" }}text-warning{{ else if eq $governmentAccess "broad" }}text-error{{ end }}">
                  {{ $accessLabel }}
                </dd>
              </div>

              {{/* Data Protection */}}
              <div class="flex justify-between py-1">
                <dt class="text-neutral-500 dark:text-neutral-400">Protection</dt>
                <dd class="font-medium {{ if eq $dataProtection "strong" }}text-success{{ else if eq $dataProtection "moderate" }}text-warning{{ else if eq $dataProtection "weak" }}text-error{{ end }}">
                  {{ $protectionLabel }}
                </dd>
              </div>

              {{/* Scope */}}
              <div class="flex justify-between py-1">
                <dt class="text-neutral-500 dark:text-neutral-400">Scope</dt>
                <dd class="font-medium">{{ $scopeLabel }}</dd>
              </div>

              {{/* Boolean flags */}}
              {{ if or $extraterritorial $requiresLocalization $requiresBackdoor }}
              <div class="pt-2 mt-2 border-t border-base-200 space-y-1">
                {{ if $extraterritorial }}
                <div class="text-neutral-600 dark:text-neutral-300">üåç Extraterritorial</div>
                {{ end }}
                {{ if $requiresLocalization }}
                <div class="text-neutral-600 dark:text-neutral-300">üìç Requires Localization</div>
                {{ end }}
                {{ if $requiresBackdoor }}
                <div class="text-error">üîë Requires Backdoor</div>
                {{ end }}
              </div>
              {{ end }}
            </dl>
          </div>
        </div>

        {{/* Applies To Card */}}
        {{ if gt (len $appliesToItems) 0 }}
        <div class="card bg-base-100 shadow-sm border border-base-300">
          <div class="card-body p-4">
            <h3 class="card-title text-sm font-semibold flex items-center gap-2">
              {{ partial "content-icon.html" (dict "name" "flag" "color" "accent" "size" "4") }}
              Applies To
            </h3>
            <ul class="space-y-1 mt-2">
              {{ range $appliesToItems }}
              <li>
                {{ if .slug }}
                <a href="/jurisdictions/{{ .slug }}/" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">
                  {{ if .flag }}{{ .flag }}{{ end }} {{ .name }}
                </a>
                {{ else }}
                <span class="text-sm">{{ if .flag }}{{ .flag }}{{ end }} {{ .name }}</span>
                {{ end }}
              </li>
              {{ end }}
            </ul>
          </div>
        </div>
        {{ end }}

        {{/* Semantic Related Laws (from related_laws frontmatter) */}}
        {{ $relatedLawsData := .Params.related_laws | default dict }}
        {{ if gt (len $relatedLawsData) 0 }}
        <div class="card bg-base-100 shadow-sm border border-base-300">
          <div class="card-body p-4">
            <h3 class="card-title text-sm font-semibold flex items-center gap-2">
              {{ partial "content-icon.html" (dict "name" "scale" "color" "warning" "size" "4") }}
              Related Laws
            </h3>
            {{/* Build a lookup map for law full names */}}
            {{ $lawsById := dict }}
            {{ range (site.Data.laws.laws.laws | default (slice)) }}
              {{ $lawsById = merge $lawsById (dict .id .) }}
            {{ end }}

            <div class="mt-2">
              {{/* Conflicts with */}}
              {{ with index $relatedLawsData "conflicts_with" }}
              <div class="mt-4 first:mt-0">
                <h4 class="text-xs font-semibold uppercase tracking-wide text-error mb-1">Conflicts with</h4>
                <ul class="space-y-0.5">
                  {{ range . }}
                  {{ $lawData := index $lawsById .id }}
                  {{ $tooltip := $lawData.full_name | default .name }}
                  <li><a href="/laws/{{ .id }}/" title="{{ $tooltip }}" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">{{ .name }}</a></li>
                  {{ end }}
                </ul>
              </div>
              {{ end }}
              {{/* Implements */}}
              {{ with index $relatedLawsData "implements" }}
              <div class="mt-4 first:mt-0">
                <h4 class="text-xs font-semibold uppercase tracking-wide text-neutral-600 dark:text-neutral-400 mb-1">Implements</h4>
                <ul class="space-y-0.5">
                  {{ range . }}
                  {{ $lawData := index $lawsById .id }}
                  {{ $tooltip := $lawData.full_name | default .name }}
                  <li><a href="/laws/{{ .id }}/" title="{{ $tooltip }}" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">{{ .name }}</a></li>
                  {{ end }}
                </ul>
              </div>
              {{ end }}
              {{/* Implemented by */}}
              {{ with index $relatedLawsData "implemented_by" }}
              <div class="mt-4 first:mt-0">
                <h4 class="text-xs font-semibold uppercase tracking-wide text-neutral-600 dark:text-neutral-400 mb-1">Implemented by</h4>
                <ul class="space-y-0.5">
                  {{ range . }}
                  {{ $lawData := index $lawsById .id }}
                  {{ $tooltip := $lawData.full_name | default .name }}
                  <li><a href="/laws/{{ .id }}/" title="{{ $tooltip }}" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">{{ .name }}</a></li>
                  {{ end }}
                </ul>
              </div>
              {{ end }}
              {{/* Interprets */}}
              {{ with index $relatedLawsData "interprets" }}
              <div class="mt-4 first:mt-0">
                <h4 class="text-xs font-semibold uppercase tracking-wide text-neutral-600 dark:text-neutral-400 mb-1">Interprets</h4>
                <ul class="space-y-0.5">
                  {{ range . }}
                  {{ $lawData := index $lawsById .id }}
                  {{ $tooltip := $lawData.full_name | default .name }}
                  <li><a href="/laws/{{ .id }}/" title="{{ $tooltip }}" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">{{ .name }}</a></li>
                  {{ end }}
                </ul>
              </div>
              {{ end }}
              {{/* Interpreted by */}}
              {{ with index $relatedLawsData "interpreted_by" }}
              <div class="mt-4 first:mt-0">
                <h4 class="text-xs font-semibold uppercase tracking-wide text-neutral-600 dark:text-neutral-400 mb-1">Interpreted by</h4>
                <ul class="space-y-0.5">
                  {{ range . }}
                  {{ $lawData := index $lawsById .id }}
                  {{ $tooltip := $lawData.full_name | default .name }}
                  <li><a href="/laws/{{ .id }}/" title="{{ $tooltip }}" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">{{ .name }}</a></li>
                  {{ end }}
                </ul>
              </div>
              {{ end }}
              {{/* Succeeds */}}
              {{ with index $relatedLawsData "succeeds" }}
              <div class="mt-4 first:mt-0">
                <h4 class="text-xs font-semibold uppercase tracking-wide text-neutral-600 dark:text-neutral-400 mb-1">Succeeds</h4>
                <ul class="space-y-0.5">
                  {{ range . }}
                  {{ $lawData := index $lawsById .id }}
                  {{ $tooltip := $lawData.full_name | default .name }}
                  <li><a href="/laws/{{ .id }}/" title="{{ $tooltip }}" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">{{ .name }}</a></li>
                  {{ end }}
                </ul>
              </div>
              {{ end }}
              {{/* Succeeded by */}}
              {{ with index $relatedLawsData "succeeded_by" }}
              <div class="mt-4 first:mt-0">
                <h4 class="text-xs font-semibold uppercase tracking-wide text-neutral-600 dark:text-neutral-400 mb-1">Succeeded by</h4>
                <ul class="space-y-0.5">
                  {{ range . }}
                  {{ $lawData := index $lawsById .id }}
                  {{ $tooltip := $lawData.full_name | default .name }}
                  <li><a href="/laws/{{ .id }}/" title="{{ $tooltip }}" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">{{ .name }}</a></li>
                  {{ end }}
                </ul>
              </div>
              {{ end }}
              {{/* Extends */}}
              {{ with index $relatedLawsData "extends" }}
              <div class="mt-4 first:mt-0">
                <h4 class="text-xs font-semibold uppercase tracking-wide text-neutral-600 dark:text-neutral-400 mb-1">Extends</h4>
                <ul class="space-y-0.5">
                  {{ range . }}
                  {{ $lawData := index $lawsById .id }}
                  {{ $tooltip := $lawData.full_name | default .name }}
                  <li><a href="/laws/{{ .id }}/" title="{{ $tooltip }}" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">{{ .name }}</a></li>
                  {{ end }}
                </ul>
              </div>
              {{ end }}
              {{/* Extended by */}}
              {{ with index $relatedLawsData "extended_by" }}
              <div class="mt-4 first:mt-0">
                <h4 class="text-xs font-semibold uppercase tracking-wide text-neutral-600 dark:text-neutral-400 mb-1">Extended by</h4>
                <ul class="space-y-0.5">
                  {{ range . }}
                  {{ $lawData := index $lawsById .id }}
                  {{ $tooltip := $lawData.full_name | default .name }}
                  <li><a href="/laws/{{ .id }}/" title="{{ $tooltip }}" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">{{ .name }}</a></li>
                  {{ end }}
                </ul>
              </div>
              {{ end }}
              {{/* Complements */}}
              {{ with index $relatedLawsData "complements" }}
              <div class="mt-4 first:mt-0">
                <h4 class="text-xs font-semibold uppercase tracking-wide text-neutral-600 dark:text-neutral-400 mb-1">Works with</h4>
                <ul class="space-y-0.5">
                  {{ range . }}
                  {{ $lawData := index $lawsById .id }}
                  {{ $tooltip := $lawData.full_name | default .name }}
                  <li><a href="/laws/{{ .id }}/" title="{{ $tooltip }}" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">{{ .name }}</a></li>
                  {{ end }}
                </ul>
              </div>
              {{ end }}
            </div>
          </div>
        </div>
        {{ end }}

        {{/* Related Laws (same jurisdiction) - kept as fallback/supplement */}}
        {{ if gt (len $appliesTo) 0 }}
        {{ $relatedLaws := slice }}
        {{ range (site.Data.laws.laws.laws | default (slice)) }}
          {{ $otherLaw := . }}
          {{ if ne $otherLaw.id $lawId }}
            {{ $found := false }}
            {{ range $otherLaw.applies_to }}
              {{ $otherId := . }}
              {{ range $appliesTo }}
                {{ if eq . $otherId }}
                  {{ $found = true }}
                {{ end }}
              {{ end }}
            {{ end }}
            {{ if $found }}
              {{ $relatedLaws = $relatedLaws | append $otherLaw }}
            {{ end }}
          {{ end }}
        {{ end }}

        {{ if gt (len $relatedLaws) 0 }}
        <div class="card bg-base-100 shadow-sm border border-base-300">
          <div class="card-body p-4">
            <h3 class="card-title text-sm font-semibold flex items-center gap-2">
              {{ partial "content-icon.html" (dict "name" "scale" "color" "secondary" "size" "4") }}
              Same Jurisdiction
            </h3>
            <ul class="space-y-1 mt-2">
              {{ range first 6 $relatedLaws }}
              <li><a href="/laws/{{ .id }}/" title="{{ .full_name | default .name }}" class="text-sm block px-2 py-1 -mx-2 rounded hover:bg-base-200 dark:hover:bg-neutral-800 no-underline">{{ .name }} <span class="opacity-60">({{ .year }})</span></a></li>
              {{ end }}
            </ul>
          </div>
        </div>
        {{ end }}
        {{ end }}

        {{/* Related content - all content types based on matching tags */}}
        {{ partial "related-content-sidebar.html" . }}

        {{/* Table of Contents - at the bottom */}}
        {{ $showToc := in .TableOfContents "<ul" }}
        {{ if $showToc }}
        <div class="mt-6">
          {{ partial "toc.html" . }}
        </div>
        {{ end }}

      </div>
    </div>

    {{/* Main content */}}
    <div class="min-w-0 flex-1">
      <div class="article-content prose dark:prose-invert max-w-none mb-20">
        {{ .Content }}

        {{/* Enriched sections from laws.json (rendered in main content, not sidebar) */}}
        {{ if or (eq $reviewStatus "verified") (eq $reviewStatus "ai-generated") }}
        {{ if or (gt (len $whatItDoes) 0) (gt (len $whoItAppliesTo) 0) (gt (len $keyProvisions) 0) (gt (len $complianceActions) 0) (index $enforcement "authority") (index $enforcement "max_fine") (index $enforcement "notes") }}
        <hr class="my-8">

        {{ if eq $reviewStatus "ai-generated" }}
        <div class="rounded-lg border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-900 dark:border-amber-900/60 dark:bg-amber-900/20 dark:text-amber-100">
          <strong>AI-generated:</strong> This section is generated from structured metadata and may contain mistakes. Verify against the official text before relying on it.
        </div>
        {{ end }}

        {{ if gt (len $whatItDoes) 0 }}
        <h2>What it does</h2>
        <ul>
          {{ range $whatItDoes }}
            <li>{{ . }}</li>
          {{ end }}
        </ul>
        {{ end }}

        {{ if gt (len $whoItAppliesTo) 0 }}
        <h2>Who it applies to</h2>
        <ul>
          {{ range $whoItAppliesTo }}
            <li>{{ . }}</li>
          {{ end }}
        </ul>
        {{ end }}

        {{ if gt (len $keyProvisions) 0 }}
        <h2>Key provisions</h2>
        {{ range $keyProvisions }}
          {{ $t := .title | default "" }}
          {{ $d := .description | default "" }}
          {{ if and $t $d }}
            <h3>{{ $t }}</h3>
            <p>{{ $d }}</p>
          {{ end }}
        {{ end }}
        {{ end }}

        {{ if gt (len $complianceActions) 0 }}
        <h2>Compliance actions</h2>
        <ul>
          {{ range $complianceActions }}
            <li>{{ . }}</li>
          {{ end }}
        </ul>
        {{ end }}

        {{ if or (index $enforcement "authority") (index $enforcement "max_fine") (index $enforcement "notes") }}
        <h2>Enforcement</h2>
        {{ with index $enforcement "authority" }}
          <p><strong>Authority:</strong> {{ . }}</p>
        {{ end }}
        {{ with index $enforcement "max_fine" }}
          <p><strong>Max fine:</strong> {{ . }}</p>
        {{ end }}
        {{ with index $enforcement "notes" }}
          <p>{{ . }}</p>
        {{ end }}
        {{ end }}
        {{ end }}
        {{ end }}

        {{/* Back link */}}
        <hr class="mt-8">
        <p>
          <a href="/laws/">‚Üê Back to all laws</a>
        </p>
      </div>
    </div>
  </section>
</article>
{{ end }}
