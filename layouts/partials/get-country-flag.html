{{/*
  Get Country Flag Partial
  Usage: {{ partial "get-country-flag.html" "NO" }}
  Returns: ğŸ‡³ğŸ‡´ (just the emoji, no wrapper)

  Looks up flag from:
  1. regions.json by identifier (country codes like NO, US, GB)
  2. jurisdictions.json blocs by identifier (eu, eea, EU_EEA, five-eyes, etc.)
  3. Special alias: UK â†’ GB

  Falls back to ğŸ³ï¸ if not found.
*/}}
{{- $code := . -}}
{{- $flag := "" -}}

{{- /* 1. Try regions.json first */ -}}
{{- $regionMatch := first 1 (where site.Data.regions "identifier" $code) -}}
{{- with index $regionMatch 0 -}}
  {{- $flag = .flag | default "" -}}
{{- end -}}

{{- /* 2. If not found, try jurisdictions.blocs */ -}}
{{- if not $flag -}}
  {{- $blocMatch := first 1 (where site.Data.jurisdictions.blocs "identifier" $code) -}}
  {{- with index $blocMatch 0 -}}
    {{- $flag = .flag | default "" -}}
  {{- end -}}
{{- end -}}

{{- /* 3. Handle special mappings (aliases not in data) */ -}}
{{- if not $flag -}}
  {{- if eq $code "UK" -}}
    {{- /* UK is an alias for GB */ -}}
    {{- $flag = "ğŸ‡¬ğŸ‡§" -}}
  {{- end -}}
{{- end -}}

{{- /* 4. Fallback */ -}}
{{- if not $flag -}}
  {{- $flag = "ğŸ³ï¸" -}}
{{- end -}}

{{- return $flag -}}
