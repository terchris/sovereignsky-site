{{/* Networks Details Card - shows cable/connection details */}}

{{/* Get identifier from front matter */}}
{{ $identifier := .Params.identifier | default "" }}

{{/* Look up connection data from networks.json */}}
{{ $networksRoot := site.Data.networks | default dict }}
{{ $connections := (index $networksRoot "networks") | default (slice) }}
{{ $connection := dict }}
{{ range $connections }}
  {{ if eq .identifier $identifier }}
    {{ $connection = . }}
  {{ end }}
{{ end }}

{{ if $connection }}
{{/* Status badge color */}}
{{ $statusColor := "badge-success" }}
{{ if eq $connection.status "planned" }}{{ $statusColor = "badge-warning" }}{{ end }}
{{ if eq $connection.status "decommissioned" }}{{ $statusColor = "badge-neutral" }}{{ end }}

{{/* Medium color - match map colors */}}
{{ $mediumColor := "" }}
{{ if eq $connection.medium "subsea" }}{{ $mediumColor = "#06b6d4" }}{{ end }}
{{ if eq $connection.medium "terrestrial" }}{{ $mediumColor = "#a855f7" }}{{ end }}

{{/* Scope emoji */}}
{{ $scopeEmoji := "" }}
{{ if eq $connection.scope "international" }}{{ $scopeEmoji = "üåç" }}{{ end }}
{{ if eq $connection.scope "domestic" }}{{ $scopeEmoji = "üè†" }}{{ end }}

<div class="card bg-base-100 shadow-sm border border-base-300">
  <div class="card-body p-4">
    <h3 class="card-title text-sm font-semibold flex items-center gap-2">
      {{ partial "icon.html" (dict "name" "info" "color" "primary" "size" "4") }}
      Connection Details
    </h3>
    <dl class="mt-2 text-sm">
      {{/* Status */}}
      <div class="flex justify-between py-1">
        <dt class="text-neutral-500 dark:text-neutral-400">Status</dt>
        <dd><span class="badge badge-sm {{ $statusColor }}">{{ $connection.status | default "unknown" | title }}</span></dd>
      </div>
      {{/* Scope */}}
      {{ with $connection.scope }}
      <div class="flex justify-between py-1">
        <dt class="text-neutral-500 dark:text-neutral-400">Scope</dt>
        <dd class="font-medium">{{ $scopeEmoji }} {{ . | title }}</dd>
      </div>
      {{ end }}
      {{/* Medium/Type */}}
      {{ with $connection.medium }}
      <div class="flex justify-between py-1">
        <dt class="text-neutral-500 dark:text-neutral-400">Medium</dt>
        <dd class="font-medium flex items-center gap-1">
          {{ if $mediumColor }}<span class="w-3 h-3 rounded-full" style="background-color: {{ $mediumColor }};"></span>{{ end }}
          {{ . | title }}
        </dd>
      </div>
      {{ end }}
      {{/* Type */}}
      {{ with $connection.type }}
      <div class="flex justify-between py-1">
        <dt class="text-neutral-500 dark:text-neutral-400">Type</dt>
        <dd class="font-medium">{{ . | title }}</dd>
      </div>
      {{ end }}
      {{/* Operational */}}
      {{ with $connection.operationalDate }}
      <div class="flex justify-between py-1">
        <dt class="text-neutral-500 dark:text-neutral-400">Operational</dt>
        <dd class="font-medium">{{ . }}</dd>
      </div>
      {{ end }}
      {{/* Length */}}
      {{ with $connection.lengthKm }}
      <div class="flex justify-between py-1">
        <dt class="text-neutral-500 dark:text-neutral-400">Length</dt>
        <dd class="font-medium">{{ . | lang.FormatNumber 0 }} km</dd>
      </div>
      {{ end }}
    </dl>
  </div>
</div>
{{ end }}
