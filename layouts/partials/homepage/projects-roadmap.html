{{/*
  projects-roadmap.html - Project roadmap display with progress bars

  Config options:
    title: Section title
    description: Section description
    background: DaisyUI background color name
    items: Array of project items with:
      - title: Project name
      - description: Project description
      - badge: Status badge text
      - badgeStyle: "primary" | "secondary" | "accent" | "neutral"
      - progress: Progress percentage (0-100)
      - progressLabel: Label for progress bar
      - fullWidth: Whether to span full width
      - subItems: Array of { title, description } sub-projects
    footer: { text, button }
*/}}

{{ $config := .config }}
{{ $id := .identifier | default "projects" }}

{{ $title := $config.title }}
{{ $description := $config.description }}
{{ $background := $config.background | default "" }}
{{ $items := $config.items | default slice }}
{{ $footer := $config.footer }}

{{/* Section wrapper */}}
<section id="{{ $id }}" class="py-16 {{ with $background }}bg-{{ . }}{{ end }} -mx-6 sm:-mx-14 md:-mx-24 lg:-mx-32">
  <div class="max-w-6xl mx-auto px-6 sm:px-14 md:px-24 lg:px-32">

    {{/* Section header */}}
    {{ if or $title $description }}
    <div class="text-center mb-12">
      {{ with $title }}
      <h2 class="text-3xl sm:text-4xl font-bold mb-4">{{ . }}</h2>
      {{ end }}
      {{ with $description }}
      <p class="text-lg opacity-80 max-w-2xl mx-auto">{{ . }}</p>
      {{ end }}
    </div>
    {{ end }}

    {{/* Projects grid */}}
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      {{ range $items }}
        {{ $fullWidth := .fullWidth | default false }}
        {{ $badgeStyle := .badgeStyle | default "primary" }}

        <div class="card bg-base-100 shadow-md {{ if $fullWidth }}lg:col-span-2{{ end }}">
          <div class="card-body">

            {{/* Header with badge */}}
            <div class="flex flex-wrap items-start justify-between gap-2 mb-2">
              <h3 class="card-title text-xl">{{ .title }}</h3>
              {{ with .badge }}
              <span class="badge badge-{{ $badgeStyle }}">{{ . }}</span>
              {{ end }}
            </div>

            {{/* Description */}}
            {{ with .description }}
            <p class="opacity-80 mb-4">{{ . }}</p>
            {{ end }}

            {{/* Progress bar */}}
            {{ with .progress }}
            <div class="mb-4">
              <div class="flex justify-between text-sm mb-1">
                <span class="opacity-70">Progress</span>
                <span class="font-medium">{{ . }}%</span>
              </div>
              <progress class="progress progress-primary w-full" value="{{ . }}" max="100"></progress>
              {{ with $.progressLabel }}
              <div class="text-xs opacity-60 mt-1">{{ . }}</div>
              {{ end }}
            </div>
            {{ end }}

            {{/* Sub-items */}}
            {{ with .subItems }}
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mt-4">
              {{ range . }}
              <div class="bg-base-200 rounded-lg p-4">
                <h4 class="font-semibold mb-1">{{ .title }}</h4>
                <p class="text-sm opacity-70">{{ .description }}</p>
              </div>
              {{ end }}
            </div>
            {{ end }}

          </div>
        </div>
      {{ end }}
    </div>

    {{/* Footer */}}
    {{ with $footer }}
    <div class="text-center mt-8">
      {{ with .text }}
      <p class="opacity-80 mb-4">{{ . }}</p>
      {{ end }}
      {{ with .button }}
      <a href="{{ .url }}"
         class="btn btn-outline btn-primary"
         {{ if .external }}target="_blank" rel="noopener"{{ end }}>
        {{ with .icon }}
        {{ partial "icon.html" (dict "name" . "size" "5" "class" "mr-2") }}
        {{ end }}
        {{ .text }}
      </a>
      {{ end }}
    </div>
    {{ end }}

  </div>
</section>
